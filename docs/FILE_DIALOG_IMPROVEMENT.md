# 文件选择对话框改进说明

## 改进内容

在文件浏览对话框中增加了**直接输入路径**的功能，使用户可以更方便地选择文件或目录。

## 新增功能

### 1. 直接输入路径字段
- 在文件选择对话框底部添加了"直接输入路径"输入框
- 用户可以直接粘贴或输入文件/目录的完整路径
- 支持按回车键快速确认

### 2. 路径验证
- 自动验证输入的路径是否存在
- 检查路径类型（文件/目录）是否与当前选择模式匹配
- 提供友好的错误提示和智能建议

### 3. 智能模式切换
- 如果输入的是目录路径但当前是文件模式，会提示是否切换到目录模式
- 自动根据当前模式更新输入框的提示文字

## 使用方法

### 方式一：传统浏览选择
1. 点击"浏览文件"按钮
2. 在文件树中导航并选择文件或目录
3. 点击"打开"确认

### 方式二：直接输入路径（新增）
1. 点击"浏览文件"按钮
2. 在底部"直接输入路径"字段中粘贴或输入路径
   - 例如：`C:\data\test.csv` 或 `C:\data\folder`
3. 点击"确认路径"按钮或按回车键
4. 系统会验证路径并自动确认

### 方式三：组合使用
1. 先在文件树中浏览到大致位置
2. 在"直接输入路径"字段中输入精确路径
3. 点击确认

## 特性说明

- **路径验证**：输入路径后会检查是否存在
- **类型检查**：确保路径类型（文件/目录）与选择模式匹配
- **智能提示**：根据当前模式显示不同的占位符提示
- **错误处理**：提供清晰的错误信息和修正建议
- **快捷操作**：支持回车键快速确认

## 实现细节

- 位置：`gui/batch_manager.py` 的 `_create_browse_dialog()` 方法
- 使用 Qt 的非原生对话框模式（`DontUseNativeDialog`）以支持自定义控件
- 在对话框布局底部添加自定义控件区域
- 包含完整的路径验证和错误处理逻辑

## 向后兼容性

- 保留了原有的所有功能
- 新功能作为增强，不影响现有使用习惯
- 如果自定义控件添加失败，会回退到原有的基本功能
